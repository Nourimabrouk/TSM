outputKalman_returns <- compute_kalmanfilter(input_returns, QML_params_returns, state_space_parameters)
outputSmooth_returns <- compute_smoothed_state(input_returns, QML_params_returns, outputKalman_returns)
outputKalman_stocks <- compute_kalmanfilter(input_stocks[,1], QML_params_stocks, state_space_parameters)
outputSmooth_stocks <- compute_smoothed_state(input_stocks[,1],QML_params_stocks, outputKalman_stocks)
outputSmooth_returns
initial_parameters = initialise_parameters_QML()
state_space_parameters = initial_parameters[[1]]
par_ini = initial_parameters[[2]]
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_stocks <- optimize_parameters(input_stocks, par_ini, state_space_parameters, TRUE)
plot(outputSmooth_returns)
plot(outputSmooth_returns$alpha)
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-1,4))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
transformed_df[[2]]
points(transformed_df[[2]], col="red")
points(transformed_df[[2]], col="red")
points(transformed_df[[2]], col="red")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(transformed_df[[2]], col="red")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(transformed_df[[2]], col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
plot(ts(returns$transformed) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(returns$transformed) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(returns$transformed) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
plot(returns$transformed , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(returns$transformed , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(returns$transformed , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(returns$transformed , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-40,40))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
library(tseries)
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(returns$transformed , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-40,40))
plot(ts(returns$transformed) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-40,40))
plot(ts(returns$transformed/100) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-40,40))
plot(ts(returns$transformed/100) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
plot(ts(returns$transformed/100) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
plot(ts(returns$transformed/100) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed/100, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*100) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*10) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*10) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
install.packages(c("tseries", "moments"))
library(tseries)
library(moments)
descriptive_stats <- function(data){
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(mean,var,min,max,skew,kurt)
return(descriptive)
}
data
descriptive_stats <- function(data){
number_observations <- nrow(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(mean,var,min,max,skew,kurt)
return(descriptive)
}
descriptive_stats <- function(data){
number_observations <- nrow(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(data,mean,var,min,max,skew,kurt)
return(descriptive)
}
returns
descriptive_a <- descriptive_stats(returns$x)
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_e <- descriptive_stats(transformed_df[1])
descriptive_stats <- function(data){
number_observations <- nrow(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(data,mean,var,min,max,skew,kurt)
return(descriptive)
}
descriptive_stats <- function(data){
number_observations <- nrow(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(data,mean,var,min,max,skew,kurt)
return(descriptive)
}
source("functions.R")
data <- read.delim(here('Data', 'sv.dat'))
stocks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)),
transformed = log(demeaned^2))
stockdata <- stocks %>%
filter(Symbol == ".SPX" & year(X1) > 2015) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
# ab
transformed_df = transform_data(stockdata, returns)
input_stocks = transformed_df[[1]]
input_returns = transformed_df[[2]]
# Descriptive stats
descriptive_a <- descriptive_stats(returns$x)
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_e <- descriptive_stats(transformed_df[1])
transformed_df[1]
descriptive_a <- descriptive_stats(returns$x)
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_a <- descriptive_stats(returns$x)
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
mean(returns$x)
descriptive_stats <- function(data){
number_observations <- nrow(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(number_observations,mean,var,min,max,skew,kurt)
return(descriptive)
}
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
source("functions.R")
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
descriptive_stats <- function(data){
number_observations <- nrow(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- c(number_observations,mean,var,min,max,skew,kurt)
return(descriptive)
}
source("functions.R")
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
source("functions.R")
#source("Plotting.R")
source("functions.R")
#source("Plotting.R")
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
source("functions.R")
# Descriptive stats
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_stats <- function(data){
number_observations <- length(data)
mean <- mean(data)
var <- var(data)
min <- min(data)
max <- max(data)
skew <- skewness(data)
kurt <- kurtosis(data)
descriptive <- data.frame(number_observations,mean,var,min,max,skew,kurt)
return(descriptive)
}
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
points(makeTS(data,1), col="red")
source("functions.R")
outputSmooth_returns <- compute_smoothed_state(input_returns, QML_params_returns, outputKalman_returns)
plot(ts(outputSmooth_returns$alpha*10) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*10) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*5) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*3) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha*3) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(returns$transformed, col="grey")
plot(ts(returns$transformed) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(outputSmooth_returns$alpha*3, col="grey")
plot(ts(returns$transformed) , col="grey", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
lines(outputSmooth_returns$alpha*3, col="red")
compute_smoothed_state <- function(data, theta, kf){
y <- as.matrix(data)
h <- kf$h
P <- kf$P
v <- kf$v
F <- kf$F
K <- kf$K
sig <- theta[1]
phi <- theta[2]
omega <- theta[3]
Z <- 1
n <- length(v)
alpha <- rep(0, n) # smoothed stated
N <- rep(0, n)     # smoothed state error variance
r <- rep(0, n)
V <- rep(0, n)     # smoothed state variance
L <- phi-K*Z
N[n] <- 0
r[n] <- 0
for (j in (n):2){ #backward recursion
N[j-1] <- (1/F[j]) + (L[j]^2) * N[j]
V[j] <- P[j] - (P[j]^2)*N[j-1]
if (is.nan(y[j]) || is.na(y[j])){
N[j-1] <- N[j]
V[j] <- P[j] - (P[j]^2)*N[j-1]
r[j-1] <- r[j]
}
else {
r[j-1] <- (v[j]/F[j]) + L[j]*r[j]
}
alpha[j] <- omega + phi*h[j] + sig*P[j]*r[j-1]
}
N[1] <- (1/F[2]) + (L[2]^2) * N[2]
N_0 <- (1/F[1]) + (L[1]^2) * N[1]
V[1] <- P[1] - (P[1]^2)*N_0
r_0 <- (v[1]/F[1]) + L[1]*r[1]
alpha[1] <- omega + phi*h[1] + sig*P[1]*r_0
Smoothedstate <- data.frame(alpha, r, N, V)
return (Smoothedstate)
}
source("functions.R")
library(tseries)
# Keer tien moet eigenlijk niet maar dan vallen ze redelijk samen
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
source("functions.R")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-30,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black", pch=19)
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black", pch=5)
# Keer tien moet eigenlijk niet maar dan vallen ze redelijk samen
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha[984]) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
[1:984]
plot(ts(outputSmooth_returns$alpha[1:984]) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
source("functions.R")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
QML_params_returns
QML_params_stocks
source("functions.R")
#source("Plotting.R")
library(here)
library(tidyverse)
library(tsibble)
library(lubridate)
library(scales)
library(ggplot2)
library(fable)
library(tseries)
library(moments)
setwd(here())
options(warn=-1)
# Data import & cleaning --------
data <- read.delim(here('Data', 'sv.dat'))
stocks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)),
transformed = log(demeaned^2))
stockdata <- stocks %>%
filter(Symbol == ".SPX" & year(X1) > 2015) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
# ab
transformed_df = transform_data(stockdata, returns)
input_stocks = transformed_df[[1]]
input_returns = transformed_df[[2]]
# Descriptive stats
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
#c / e -> need to separate these?
initial_parameters = initialise_parameters_QML()
state_space_parameters = initial_parameters[[1]]
par_ini = initial_parameters[[2]]
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_stocks <- optimize_parameters(input_stocks, par_ini, state_space_parameters, TRUE)
QML_params_returns
QML_params_returns
source("functions.R")
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_stocks <- optimize_parameters(input_stocks, par_ini, state_space_parameters, TRUE)
QML_params_returns
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_returns
source("functions.R")
source("functions.R")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
compute_smoothed_state(input_returns, QML_params_returns, outputKalman_returns)
plot(outputSmooth_returns$N)
optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE)
source("functions.R")
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_returns
source("functions.R")
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_out
QML_params_returns
QML_params_returns
data <- read.delim(here('Data', 'sv.dat'))
stocks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)),
transformed = log(demeaned^2))
stockdata <- stocks %>%
filter(Symbol == ".SPX" & year(X1) > 2015) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
# ab
transformed_df = transform_data(stockdata, returns)
input_stocks = transformed_df[[1]]
input_returns = transformed_df[[2]]
# Descriptive stats
descriptive_a <- descriptive_stats(returns$x)
descriptive_a
descriptive_b <- descriptive_stats(returns$transformed)
descriptive_b
descriptive_e <- descriptive_stats(stockdata$RV)
descriptive_e
#c / e -> need to separate these?
par_ini <- c(0.1082, 0.98, -0.2, 0.9)
initial_parameters = initialise_parameters_QML(par_ini)
state_space_parameters = initial_parameters[[1]]
par_ini = initial_parameters[[2]]
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_stocks <- optimize_parameters(input_stocks, par_ini, state_space_parameters, TRUE)
#d
outputKalman_returns <- compute_kalmanfilter(input_returns, QML_params_returns, state_space_parameters)
outputSmooth_returns <- compute_smoothed_state(input_returns, QML_params_returns, outputKalman_returns)
outputKalman_stocks <- compute_kalmanfilter(input_stocks[,1], QML_params_stocks, state_space_parameters)
outputSmooth_stocks <- compute_smoothed_state(input_stocks[,1],QML_params_stocks, outputKalman_stocks)
source("functions.R")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
outputKalman_returns
QML_params_returns
source("functions.R")
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_returns
source("functions.R")
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_returns
source("functions.R")
source("functions.R")
- compute_kalmanfilter(input_returns, QML_params_returns, state_space_parameters)
outputKalman_returns
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE)
QML_params_returns
#d
outputKalman_returns <- compute_kalmanfilter(input_returns, QML_params_returns, state_space_parameters)
outputSmooth_returns <- compute_smoothed_state(input_returns, QML_params_returns, outputKalman_returns)
outputKalman_stocks <- compute_kalmanfilter(input_stocks[,1], QML_params_stocks, state_space_parameters)
outputSmooth_stocks <- compute_smoothed_state(input_stocks[,1],QML_params_stocks, outputKalman_stocks)
source("functions.R")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,1))
points(returns$transformed, col="black")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
source("functions.R")
outputKalman_returns <- compute_kalmanfilter(input_returns, QML_params_returns, state_space_parameters)
h_t <- outputKalman_returns$h_t
xi <- QML_params_returns[3]/(1-QML_params_returns[2])
xi <- QML_params_returns[3]/(1-QML_params_returns[2])
h_t <- outputKalman_returns$h_t
H_filtered <- h_t-xi
H_filtered <- h_t-xi
H_filtered
plot(ts(H_filtered), col="red", plot.type="single", ylab="", main="H_t")
H_smoothed <- outputsmooth_returns$alpha-xi
plot(ts(H_smoothed), col="red", plot.type="single", ylab="", main="H_t Smoothed")
outputsmooth_returns$alpha
H_smoothed <- outputSmooth_returns$alpha-xi
plot(ts(H_smoothed), col="red", plot.type="single", ylab="", main="H_t Smoothed")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-4,1))
points(returns$transformed, col="black")
source("functions.R")
plot(ts(outputSmooth_returns$alpha) , col="red", plot.type="single", ylab="", main="h_t", ylim=c(-20,5))
points(returns$transformed, col="black")
QML_params_returns
outputSmooth_returns
outputSmooth_stocks
QML_params_stocks
QML_params_stocks <- optimize_parameters(input_stocks, par_ini, state_space_parameters, TRUE)
QML_params_stocks
par_ini <- c(0.1082, 0.98, -0.2, 0.9)
initial_parameters = initialise_parameters_QML(par_ini)
state_space_parameters = initial_parameters[[1]]
par_ini = initial_parameters[[2]]
QML_params_returns <- optimize_parameters(input_returns, par_ini, state_space_parameters, TRUE) # (Print_output = TRUE)
QML_params_stocks <- optimize_parameters(input_stocks, par_ini, state_space_parameters, TRUE)
#d
outputKalman_returns <- compute_kalmanfilter(input_returns, QML_params_returns, state_space_parameters)
outputSmooth_returns <- compute_smoothed_state(input_returns, QML_params_returns, outputKalman_returns)
outputKalman_stocks <- compute_kalmanfilter(input_stocks[,1], QML_params_stocks, state_space_parameters)
outputSmooth_stocks <- compute_smoothed_state(input_stocks[,1],QML_params_stocks, outputKalman_stocks)
QML_params_stocks
