<<<<<<< HEAD
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(df_kalman_missing_data, df_smoothed_state_missing_data)
rm(list=ls())
"
TSM Assignment 1
Figures:
2.1 Done
2.2 Done
2.3 First observation missing? Something not completely right atleast
2.5 Panel (iv) missing
2.6 - 2.9 Convert to packageless implementation
"
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here())
data = Nile
# 2.1 Kalman Filter
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
rm(list=ls())
"
TSM Assignment 1
Figures:
2.1 Done
2.2 Done
2.3 First observation missing? Something not completely right atleast
2.5 Panel (iv) missing
2.6 - 2.9 Convert to packageless implementation
"
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here())
data = Nile
# 2.1 Kalman Filter
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
source("functions.R")
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
source("functions.R")
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
rm(list=ls())
"
TSM Assignment 1
Figures:
2.1 Done
2.2 Done
2.3 First observation missing? Something not completely right atleast
2.5 Panel (iv) missing
2.6 - 2.9 Convert to packageless implementation
"
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here())
data = Nile
# 2.1 Kalman Filter
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
=======
# Creates figure 2.5
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
<<<<<<< HEAD
View(df_smoothed_state_missing_data)
View(df_smoothed_state_missing_data)
rm(list=ls())
=======
# 2.6
# 2.7
# 2.8
# 2.9
one_step_ahead_forecast <- function(data, theta, sig_eps, sig_eta, n_steps){
}
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
"
Time Series Models
Assignment 1
Authors:
Zeus Paraguas
Bart
Jari
Nouri Mabrouk 2623401
Main file to run the analysis
"
<<<<<<< HEAD
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here())
data = Nile
# 2.1 Kalman Filter
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
"
Time Series Models
Assignment 1
Authors:
Zeus Paraguas
Bart
Jari
Nouri Mabrouk 2623401
Main file to run the analysis
"
=======
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
rm(list=ls())
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here("Data"))
data = Nile
# 2.1 Kalman Filter
# Initialises values
# Applies Kalman Filter
# Plots results (figure 2.1)
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
# Creates figure 2.2
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
# Creates figure 2.3
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
# Creates missing data
# Runs Kalman filter, state smoother, and disturbance smoother
# Creates figure 2.5
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
# 2.6
# 2.7
# 2.8
# 2.9
<<<<<<< HEAD
source("functions.R")
=======
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
"
Time Series Models
Assignment 1
Authors:
Zeus Paraguas
Bart
Jari
Nouri Mabrouk 2623401
Main file to run the analysis
"
rm(list=ls())
<<<<<<< HEAD
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here("Data"))
data = Nile
# 2.1 Kalman Filter
# Initialises values
# Applies Kalman Filter
# Plots results (figure 2.1)
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
# Creates figure 2.2
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
# Creates figure 2.3
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
# Creates missing data
# Runs Kalman filter, state smoother, and disturbance smoother
# Creates figure 2.5
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
# 2.6
# 2.7
# 2.8
# 2.9
"
Time Series Models
Assignment 1
Authors:
Zeus Paraguas
Bart
Jari
Nouri Mabrouk 2623401
Main file to run the analysis
"
rm(list=ls())
=======
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
<<<<<<< HEAD
# Data import--------
setwd(here("Data"))
data = Nile
# 2.1 Kalman Filter
# Initialises values
# Applies Kalman Filter
# Plots results (figure 2.1)
=======
setwd(here("Data"))
data = Nile
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
<<<<<<< HEAD
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
# Creates figure 2.2
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
# Creates figure 2.3
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
# Creates missing data
# Runs Kalman filter, state smoother, and disturbance smoother
# Creates figure 2.5
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
# 2.6
# 2.7
# 2.8
# 2.9
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
rm(list=ls())
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
source("functions.R")
"
Time Series Models
Assignment 1
Authors:
Zeus Paraguas
Bart
Jari
Nouri Mabrouk 2623401
Main file to run the analysis
"
=======
source("functions.R")
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
rm(list=ls())
# Imports ----------
library(tidyverse)
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here("Data"))
data = Nile
# 2.1 Kalman Filter
# Initialises values
# Applies Kalman Filter
# Plots results (figure 2.1)
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
# Creates figure 2.2
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
# Creates figure 2.3
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
# Creates missing data
# Runs Kalman filter, state smoother, and disturbance smoother
# Creates figure 2.5
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
# 2.6
# 2.7
# 2.8
# 2.9
<<<<<<< HEAD
=======
source("functions.R")
# Imports ----------
library(here)
source("functions.R")
options(warn=-1)
one_step_ahead_forecast <- function(data, theta, sig_eps, sig_eta, n_steps){
return(data)
}
plotOne <- function(df){
"
Goal: Plot figure 2.1
Input: df_kalman_filtered_state
Output: Plot 2.1
"
# Input:
n <- nrow(df)
filtered_state <- df$a[2:n]
filtered_state_lb <- df$a_lb[2:n]
filtered_state_ub <- df$a_ub[2:n]
filtered_variance <- df$P[2:n]
state_error <- df$v[2:n]
state_error_variance <- df$F[2:n]
par(mfrow=c(2,2),mar=c(4.1,4.1,1.1,2.1))
plot(makeTS(filtered_state), plot.type="single", ylab="", main="i", ylim=create_ylim(data))
lines(makeTS(filtered_state_lb), col="red")
lines(makeTS(filtered_state_ub), col="red")
points(makeTS(data))
plot(makeTS(filtered_variance), plot.type="single", ylab="", main="ii", ylim=create_ylim(filtered_variance))
plot(makeTS(state_error), plot.type="single", ylab="", main="iii", ylim=create_ylim(state_error))
abline(h=0,col="red")
plot(makeTS(state_error_variance), plot.type="single", ylab="", main="iv", ylim=create_ylim(state_error_variance))
}
kalman_filter <- function(data, theta, sig_eps, sig_eta){
"
Goal: Apply the kalman filter recursion
Input: data, theta, sig_eps, sig_eta
Output: DF 100x9 - data.frame(a, P, v, F, K, a_y, P_y, a_lb, a_ub)
"
y <- as.matrix(data)
n <- nrow(y)
a <- rep(0,n)   # filter estimator
P <- rep(0,n)   # variance of filtered estimator
v <- rep(0,n)   # prediction error
F <- rep(0,n)   # variance of prediction error
K <- rep(0,n)   # kalman gain
a_y <- rep(0,n) # one-step ahead estimator
P_y <- rep(0,n) # variance of one-step ahead estimator
a[1] <- theta[1]
P[1] <- theta[2]
for (i in 1:n) {
v[i] <- y[i] - a[i]
F[i] <- P[i] + sig_eps
if(is.nan(y[i]) || is.na(y[i])){
K[i] <- 0
a_y[i] <- a[i]
P_y[i] <- P[i]
a[i+1] <- a[i]
P[i+1] <- P[i] + sig_eta
} else{
K[i] <- P[i]/F[i]
a_y[i] <- a[i] + K[i]*v[i]
P_y[i]  = P[i]*(1-K[i])
if(i < (n-1)){
a[i+1] <- a[i] + K[i]*v[i]
P[i+1] <- P[i] * (1-K[i]) + sig_eta
}
a[n] <- a[n-1] + K[n-1]*v[n-1]
P[n] <- P[n-1] * (1-K[n-1]) + sig_eta
}
# Upper and lower bounds of a
a_lb <- a-1.645*sqrt(P)
a_ub <- a+1.645*sqrt(P)
kalman <- data.frame(a, P, v, F, K, a_y, P_y, a_lb, a_ub)
return(kalman)
}
smoothed_state <- function(df){
"
Goal: Compute smoothed state through reverse loop
Input: df_kalman_filtered_state (output of kalman filter function)
Output: DF 100x6 - data.frame(alpha, N, r, V, alpha_lb, alpha_ub)
"
a <- df$a
P <- df$P
v <- df$v
F <- df$F
K <- df$K
n <- length(v)
alpha <- rep(0,n) # smoothed stated
N <- rep(0,n)     # smoothed state error variance
r <- rep(0,n)
V <- rep(0,n)     # smoothed state variance
L <- 1 - K
V[1] = P[1]
N[n] <- 0
r[n] <- 0
for (j in n:2){ #reversed loop
if (j > 1){
N[j-1] <- (1/F[j]) + L[j]^2 * N[j]
V[j] <- P[j] - P[j]^2 * N[j-1]
}
if (is.nan(v[j]) || is.na(v[j])){
r[j-1] <- r[j]
alpha[j] <- a[j] + P[j]*r[j-1]
}
else {
r[j-1] <- (v[j]/F[j])+L[j]*r[j]
alpha[j] <- a[j]+P[j]*r[j-1]
}
#upper and lower bounds of alpha
alpha_lb <- alpha - 1.645*sqrt(V)
alpha_ub <- alpha + 1.645*sqrt(V)
SmoothedState_df <- data.frame(alpha, N, r, V, alpha_lb, alpha_ub)
return (SmoothedState_df)
}
disturbances_smoothing <- function(dfKalman, dfSmoothed){
"
Goal: Apply disturbance smoothing
Input: df_kalman_filtered_state,df_smoothed_state (output of kalman, smoothedstate functions)
Output: DF 100x4 - data.frame(eps,eta,sd_eps,sd_eta)
"
F <- dfKalman$F
V <- dfKalman$v
K <- dfKalman$K
r <- dfSmoothed$r
N <- dfSmoothed$N
u <- 1/F*V-K*r
eps <- sig_eps*u
D <- 1/F + K^2*N
var_eps <- sig_eps - sig_eps^2*D
eta <- sig_eta*r
var_eta <- sig_eta - sig_eta^2*N
sd_eps <- sqrt(var_eps)
sd_eta <- sqrt(var_eta)
disturbance <- data.frame(eps,eta,sd_eps,sd_eta)
return(disturbance)
}
create_ylim <- function(vector){
"
Goal: Create min-max range from data
Input: Vector
Output: List c(min, max)
"
return(c(min(vector, na.rm=TRUE), max(vector, na.rm=TRUE)))
}
makeTS <- function(vector){
"
Goal: Convert vector into time series starting in 1871
Input: Vector
Output: Time series
"
ts <- ts(vector, start=c(1871,1))
return(ts)
}
one_step_ahead_forecast <- function(data, theta, sig_eps, sig_eta, n_steps){
return(data)
}
plotOne <- function(df){
"
Goal: Plot figure 2.1
Input: df_kalman_filtered_state
Output: Plot 2.1
"
# Input:
n <- nrow(df)
filtered_state <- df$a[2:n]
filtered_state_lb <- df$a_lb[2:n]
filtered_state_ub <- df$a_ub[2:n]
filtered_variance <- df$P[2:n]
state_error <- df$v[2:n]
state_error_variance <- df$F[2:n]
par(mfrow=c(2,2),mar=c(4.1,4.1,1.1,2.1))
plot(makeTS(filtered_state), plot.type="single", ylab="", main="i", ylim=create_ylim(data))
lines(makeTS(filtered_state_lb), col="red")
lines(makeTS(filtered_state_ub), col="red")
points(makeTS(data))
plot(makeTS(filtered_variance), plot.type="single", ylab="", main="ii", ylim=create_ylim(filtered_variance))
plot(makeTS(state_error), plot.type="single", ylab="", main="iii", ylim=create_ylim(state_error))
abline(h=0,col="red")
plot(makeTS(state_error_variance), plot.type="single", ylab="", main="iv", ylim=create_ylim(state_error_variance))
}
plotTwo <- function(df){
"
Goal: Plot figure 2.4
Input: df_smoothed_state
Output: Plot 2.4
"
n <- nrow(df)
smooth_state <- df$alpha[2:n]
smooth_state_lb <- df$alpha_lb[2:n]
smooth_state_ub <- df$alpha_ub[2:n]
smooth_variance <- df$V[2:n]
state_error <- df$r[1:(n-1)]
state_error_variance <- df$N[1:(n-1)]
par(mfrow=c(2,2),mar=c(4.1,4.1,1.1,2.1))
plot(makeTS(smooth_state), plot.type="single", ylab="", main="i", ylim=create_ylim(data))
lines(makeTS(smooth_state_lb), col="red")
lines(makeTS(smooth_state_ub), col="red")
points(makeTS(data), col="red")
plot(makeTS(smooth_variance), plot.type="single", ylab="", main="ii", ylim=create_ylim(smooth_variance))
plot(makeTS(state_error), plot.type="single", ylab="", main="iii", ylim=create_ylim(state_error))
abline(h=0,col="red")
plot(makeTS(state_error_variance), plot.type="single", ylab="", main="iv", ylim=create_ylim(state_error_variance))
}
plotThree <- function(df){
"
Goal: Plot figure 2.3
Input: df_disturbance
Output: Plot 2.3
"
n <- nrow(df)
observation_error <- df$eps[2:n]
observation_error_variance <- df$sd_eps[2:n]
state_error <- df$eta[2:n]
state_error_variance <- df$sd_eta[2:n]
par(mfrow=c(2,2),mar=c(4.1,4.1,1.1,2.1))
plot(makeTS(observation_error), plot.type="single", ylab="", main="i", ylim=create_ylim(observation_error))
abline(h=0, col="red")
plot(makeTS(observation_error_variance), plot.type="single", ylab="", main="ii", ylim=create_ylim(observation_error_variance))
plot(makeTS(state_error), plot.type="single", ylab="", main="iii", ylim=create_ylim(state_error))
abline(h=0, col="red")
plot(makeTS(state_error_variance), plot.type="single", ylab="", main="iv", ylim=create_ylim(state_error_variance))}
plotFive <- function(df_data, df_k, df_s){
"
Goal: Plot figure 2.5
Input: df_data, df_kalman_missing_data, df_smoothed_missing_data
Output: Plot 2.5
"
n <- length(df_data)
filtered_state <- df_k$a[2:n]
filtered_variance <- df_k$P[2:n]
smoothed_state <- df_s$alpha[2:n]
smoothed_state_variance <- df_s$V[2:n]
par(mfrow=c(2,2),mar=c(4.1,4.1,1.1,2.1))
plot(makeTS(filtered_state), col="red", plot.type="single", ylab="", main="i", ylim=create_ylim(df_data))
lines(makeTS(df_data))
plot(makeTS(filtered_variance), plot.type="single", ylab="", main="ii", ylim=create_ylim(filtered_variance))
plot(makeTS(smoothed_state), col="red", plot.type="single", ylab="", main="iii", ylim=create_ylim(df_data))
lines(makeTS(df_data))
plot(makeTS(smoothed_state_variance), plot.type="single", ylab="", main="iv", ylim=create_ylim(smoothed_state_variance))
}
plotSix <- function(df){
"
Goal: Plot Forecasting 2.6
Input:
Output: Plot 2.6
"
}
plotSeven <- function(df){
"
Goal: Plot Diagnostic Plots prediction errors 2.7
Input:
Output: Plot 2.7
"
}
plotEight <- function(df){
"
Goal: Plot Diagnostic Plots auxilliary residuals 2.8
Input:
Output: Plot 2.8
"
}
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
"
Time Series Models
Assignment 1
Authors:
Zeus Paraguas
Bart
Jari
Nouri Mabrouk 2623401
Main file to run the analysis
"
rm(list=ls())
# Imports ----------
library(here)
source("functions.R")
options(warn=-1)
# Data import--------
setwd(here("Data"))
data = Nile
# 2.1 Kalman Filter
# Initialises values
# Applies Kalman Filter
# Plots results (figure 2.1)
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
# 2.2  Smoothed State
# Creates figure 2.2
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
# 2.3 Disturbance Smoothing
# Creates figure 2.3
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
# 2.5 Missing data
# Creates missing data
# Runs Kalman filter, state smoother, and disturbance smoother
# Creates figure 2.5
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
# 2.6
# 2.7
# 2.8
# 2.9
getwd()
setwd(here())
# Data import--------
getwd()
data = here("Data", Nile)
data
data = here("Data", "Nile.dat")
data
data = Nile
setwd(here())
data = Nile
data
getwd()
data = Nile
source("functions.R")
options(warn=-1)
data = Nile
sig_eps <- 15099
sig_eta <- 1469.1
a_ini <- 0
P_ini <- 10^7
theta <- c(a_ini, P_ini)
df_kalman_filtered_state <- kalman_filter(data, theta, sig_eps, sig_eta)
plotOne(df_kalman_filtered_state)
df_smoothed_state <- smoothed_state(df_kalman_filtered_state)
plotTwo(df_smoothed_state)
df_disturbance <- disturbances_smoothing(df_kalman_filtered_state, df_smoothed_state)
plotThree(df_disturbance)
missing_values_index <- c(21:40, 61:80)
data_missing <- data
data_missing[missing_values_index] <- NA
df_kalman_missing_data <- kalman_filter(data_missing, theta, sig_eps, sig_eta)
df_smoothed_state_missing_data <- smoothed_state(df_kalman_missing_data)
df_disturbance_missing_data <- disturbances_smoothing(df_kalman_missing_data, df_smoothed_state_missing_data)
plotFive(data_missing, df_kalman_missing_data, df_smoothed_state_missing_data)
# 2.6
# 2.7
# 2.6
# 2.7
# 2.8
# 2.6
# 2.7
# 2.8
# 2.9
# 2.6
# 2.7
# 2.8
# 2.9
# 2.6
# 2.7
# 2.8
# 2.9
# 2.6
# 2.7
# 2.8
# 2.9
# 2.6
# 2.7
# 2.8
# 2.9
# 2.6
# 2.7
# 2.8
# 2.9
<<<<<<< HEAD
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
source("functions.R")
=======
>>>>>>> 4729ed80354ed8a7f63120a9a0878d5648eed487
