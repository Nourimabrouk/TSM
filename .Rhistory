res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
0.3*0.3
source("functions.R")
par_ini <- c(0.08, 0.9, 0.2)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
0.3484^2
source("functions.R")
par_ini <- c(0.08, 0.9, -0.2)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
source("functions.R")
par_ini <- c(2, 0.9, -0.2)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
0.3317^2
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
source("functions.R")
par_ini <- c(0.3, 0.9, -0.2)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
log(0.3)
exp(0.3)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
h <- rep(0,N)
y <- rep(0,N)
epsilon <- rnorm(n)
eta <- sigma*rnorm(n)
N <- 10000
phi = 0.98
sigma <- 0.3317
omega <- -0.21
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
h <- rep(0,N)
y <- rep(0,N)
epsilon <- rnorm(n)
eta <- sigma*rnorm(n)
N <- 10000
phi = 0.98
sigma <- 0.3317
omega <- -0.21
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
h <- rep(0,N)
y <- rep(0,N)
epsilon <- rnorm(n)
eta <- sigma*rnorm(n)
N <- 10000
phi = 0.98
sigma <- 0.3317
omega <- -0.21
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
h <- rep(0,N)
y <- rep(0,N)
N <- 10000
phi = 0.98
sigma <- 0.3317
omega <- -0.21
epsilon <- rnorm(n)
eta <- sigma*rnorm(n)
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
eta <- sigma*rnorm(n)
h <- rep(0,N)
y <- rep(0,N)
N <- 10000
phi = 0.98
sigma <- 0.3317
omega <- -0.21
epsilon <- rnorm(N)
eta <- sigma*rnorm(N)
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
par_ini <- c(2, 0.9, 0.8)
ret_trans <- y
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.05, 0.9, 0.8)
ret_trans <- y
res <- state_space_parameter_optimizer(ret_trans, par_ini)
ret_trans <- y
res <- state_space_parameter_optimizer(ret_trans, par_ini)
res <- state_space_parameter_optimizer(ret_trans, par_ini)
epsilon <- rnorm(N)
eta <- rnorm(N,0,sigma)
var(sigma)
var(eta)
epsilon <- rnorm(N)
eta <- rnorm(N,0,sigma^2)
var(eta)
epsilon <- rnorm(N)
eta <- rnorm(N,0,sqrt(sigma))
var(eta)
par_ini <- c(0.05, 0.9, 0.8)
ret_trans <- y
res <- state_space_parameter_optimizer(ret_trans, par_ini)
h <- rep(0,N)
y <- rep(0,N)
N <- 10000
phi <- 0.98
sigma <- 0.3317
omega <- -0.21
epsilon <- rnorm(N)
eta <- rnorm(N,0,sqrt(sigma))
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
par_ini <- c(0.05, 0.9, 0.8)
ret_trans <- y
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(4, 0.9, 0.8)
ret_trans <- y
res <- state_space_parameter_optimizer(ret_trans, par_ini)
<<<<<<< Updated upstream
# e)
# Overview of dataset
stonks %>% head
colnames(stonks)
unique(stonks$Symbol)
range(stonks$X1)
# Data prep
#Quickplots
autoplot(returns, demeaned)
autoplot(returns, transformed)
autoplot(stonkdata, Close)
autoplot(stonkdata, RV)
range(returns$demeaned)
# 14.5 (i)
ggplot(returns, aes(index, demeaned))+
theme_minimal()+
geom_line()+
geom_hline(yintercept = 0)+
scale_x_continuous(breaks = seq(0,900,100))
# 14.5 (ii)
ggplot(returns, aes(index))+
theme_minimal()+
geom_point()+
# + geom_line(smoothed_estimate k+theta)
geom_hline(yintercept = 0)+
scale_x_continuous(breaks = seq(0,900,100))
# 14.5 (iii)
# ggplot(returns, aes(index, SE_volmeasure))+
#   theme_minimal()+
#   geom_line()
colnames(stonks)
stonkdata
#Quickplots
autoplot(returns, demeaned)
autoplot(returns, transformed)
"
Time Series Models
Assignment 2
Authors:
Zeus Paraguas 2624650
Bart
Jari Verbeek 2580924
Nouri Mabrouk 2623401
This code applies CH 2 of the book including the figures presented to our own time series
"
rm(list=ls())
source("Functions.R")
source("Plotting.R")
library(here)
library(tidyverse)
library(tsibble)
library(lubridate)
library(scales)
library(ggplot2)
library(fable)
setwd(here())
options(warn=-1)
data <- read.delim(here('Data', 'sv.dat'))
stonks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = x - mean(x),
transformed = log(demeaned ^ 2) )
stonkdata <- stonks %>%
filter(Symbol == ".AEX" & year(X1) > 2013) %>%
select(X1,close_price,rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
returns
stonkdata
source("Functions.R")
par_ini <- c(2, 0.8, 0.9)
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
# Overview of dataset
stonks %>% head
colnames(stonks)
unique(stonks$Symbol)
range(stonks$X1)
#Quickplots
autoplot(returns, demeaned)
autoplot(returns, transformed)
autoplot(stonkdata, Close)
autoplot(stonkdata, RV)
autoplot(returns, demeaned)
autoplot(returns, transformed)
autoplot(stonkdata, Close)
autoplot(stonkdata, RV)
#Quickplots
autoplot(returns, demeaned)
autoplot(returns, transformed)
autoplot(stonkdata, Close)
autoplot(stonkdata, RV)
# 14.5 (i)
ggplot(returns, aes(index, demeaned))+
theme_minimal()+
geom_line()+
geom_hline(yintercept = 0)+
scale_x_continuous(breaks = seq(0,900,100))
# 14.5 (ii)
ggplot(returns, aes(index))+
theme_minimal()+
geom_point()+
# + geom_line(smoothed_estimate k+theta)
geom_hline(yintercept = 0)+
scale_x_continuous(breaks = seq(0,900,100))
autoplot(returns, transformed)
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x) / 100 ),
transformed = log(demeaned ^ 2) )
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)) / 100 ,
transformed = log(demeaned ^ 2) )
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)) / 100 ,
transformed = log(demeaned ^ 2) )
#Quickplots
autoplot(returns, demeaned)
# 14.5 (i)
ggplot(returns, aes(index, demeaned))+
theme_minimal()+
geom_line()+
geom_hline(yintercept = 0)+
scale_y_continuous(breaks = seq(-.05,.05,.025))
# 14.5 (i)
ggplot(returns, aes(index, demeaned))+
theme_minimal()+
geom_line()+
geom_hline(yintercept = 0)+
scale_y_continuous(breaks = seq(-.05,.05,.025))+
scale_x_continuous(breaks = seq(0,900,100))
returns
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)) ,
transformed = log(demeaned ^ 2) )
returns
returns %>% min(transformed)
returns %>% select(transformed) %>% min()
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)) ,
transformed = log(demeaned ^ 2) )
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x)) /100 ,
transformed = log(demeaned ^ 2) )
stonkdata <- stonks %>%
filter(Symbol == ".AEX" & year(X1) > 2013) %>%
select(X1,close_price,rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
returns %>% select(transformed) %>% min()
=======
>>>>>>> Stashed changes
par_ini <- c(4, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
"
Time Series Models
Assignment 2
Authors:
Zeus Paraguas 2624650
Bart
Jari Verbeek 2580924
Nouri Mabrouk 2623401
This code applies CH 2 of the book including the figures presented to our own time series
"
rm(list=ls())
# Imports ----------
source("functions.R")
source("Plotting.R")
library(here)
library(tidyverse)
library(tsibble)
library(lubridate)
library(scales)
library(ggplot2)
library(fable)
setwd(here())
options(warn=-1)
# Data import--------
data <- read.delim(here('Data', 'sv.dat'))
stonks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x))/100,
transformed = log(demeaned^2))
stonkdata <- stonks %>%
filter(Symbol == ".AEX" & year(X1) > 2013) %>%
select(X1,close_price,rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
returns
stonkdata
source("functions.R")
h <- rep(0,N)
y <- rep(0,N)
N <- 10000
phi <- 0.98
sigma <- 0.3317
omega <- -0.21
epsilon <- rnorm(N)
eta <- rnorm(N,0,sqrt(sigma))
for (t in 1:N){
h[t] <- omega + phi*h[t] + sigma*eta[t]
y[t] <- h[t] + epsilon[t]
}
par_ini <- c(4, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
# e)
# Overview of dataset
stonks %>% head
colnames(stonks)
unique(stonks$Symbol)
range(stonks$X1)
# Data prep
#Quickplots
autoplot(returns, demeaned)
autoplot(returns, transformed)
autoplot(stonkdata, Close)
autoplot(stonkdata, RV)
range(returns$demeaned)
# 14.5 (i)
ggplot(returns, aes(index, demeaned))+
theme_minimal()+
geom_line()+
geom_hline(yintercept = 0)+
scale_y_continuous(breaks = seq(-.05,.05,.025))+
scale_x_continuous(breaks = seq(0,900,100))
# # 14.5 (ii)
# ggplot(returns, aes(index))+
#   theme_minimal()+
#   geom_point()+
#   # + geom_line(smoothed_estimate k+theta)
#   geom_hline(yintercept = 0)+
#   scale_x_continuous(breaks = seq(0,900,100))
# 14.5 (iii)
# ggplot(returns, aes(index, SE_volmeasure))+
#   theme_minimal()+
#   geom_line()
par_ini <- c(4, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(4, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(4, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
state_space_parameter_optimizer <- function(df_data, phi_ini){
print(phi_ini)
results <- optim(par=phi_ini, fn=function(par) - GetloglikGauss(df_data, par), method="BFGS")
theta_hat <- results$par
print("The parameter estimates are:")
print(round(theta_hat, 4))
print("The log-likelihood value is:")
print(results$value)
print("iterations:")
print(results$counts[1])
cat("Exit flag:")
print(results$convergence) # zero indicates succesfull optimization
return(theta_hat)
}
state_space_parameter_optimizer <- function(df_data, phi_ini){
print(phi_ini)
results <- optim(par=phi_ini, fn=function(par) - GetloglikGauss(df_data, par), method="BFGS")
theta_hat <- results$par
print("The parameter estimates are:")
print(round(theta_hat, 4))
print("The log-likelihood value is:")
print(results$value)
print("iterations:")
print(results$counts[1])
cat("Exit flag:")
print(results$convergence) # zero indicates succesfull optimization
return(theta_hat)
}
par_ini <- c(4, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
source("functions.R")
par_ini <- c(2, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.08, 0.9, 0.8)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.08, 0.9, 0.06)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.08, 0.9, -0.06)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.00, 0.9, -0.06)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.05, 0.9, -0.06)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
par_ini <- c(0.1, 0.9, -0.06)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini)
