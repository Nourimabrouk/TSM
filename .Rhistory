# # 14.5 (ii)
# ggplot(returns, aes(index))+
#   theme_minimal()+
#   geom_point()+
#   # + geom_line(smoothed_estimate k+theta)
#   geom_hline(yintercept = 0)+
#   scale_x_continuous(breaks = seq(0,900,100))
# 14.5 (iii)
# ggplot(returns, aes(index, SE_volmeasure))+
#   theme_minimal()+
#   geom_line()
# h <- rep(0,N)
# y_simulate <- rep(0,N)
#
#
# N <- 10000
# phi <- 0.99
# sigma <- 0.08
# omega <- 0.2
#
# epsilon <- rnorm(N)
# eta <- rnorm(N,0, sqrt(sigma))
#
# h[1] <- omega
#
# for (t in 1:N){
#   y_simulate[t] <- h[t] + epsilon[t]
#   h[t+1] <- omega + phi*h[t] + sigma*eta[t]
# }
#
# source("functions.R")
# res2 <- state_space_parameter_optimizer(y_simulate, par_ini, state_space_parameters)
source("functions.R")
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
source("functions.R")
sig_eps <- (pi^2)/2
mean_u <- -1.27
par_ini <- c(0.08, 0.95, 0.25, 0.5)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- 0
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
sig_eps <- (pi^2)/2
mean_u <- -1.27
par_ini <- c(0.08, 0.95, 0.25, 0.5)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
View(stonks_data1)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
stonkdata <- stonks %>%
filter(Symbol == ".AEX" & year(X1) > 2015) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)
) %>%
as_tsibble()
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
rv <- stonkdata$RV[-1]
stonks_data1 <- cbind(x, rv)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini1 <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
stonkdata <- stonks %>%
filter(Symbol == ".SPX" & year(X1) > 2011) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)
) %>%
as_tsibble()
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
stonkdata <- stonks %>%
filter(Symbol == ".SPX" & year(X1) > 2011) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)
) %>%
as_tsibble()
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
rv <- stonkdata$RV[-1]
stonks_data1 <- cbind(x, rv)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini1 <- c(0.2, 0.95, 0.25, 0.6)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.3)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
source("functions.R")
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
stonkdata
source("functions.R")
sig_eps <- (pi^2)/2
mean_u <- -1.27
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
stonks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
stonkdata <- stonks %>%
filter(Symbol == ".SPX" & year(X1) > 2011) %>%
select(X1,close_price, rv5) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)
) %>%
as_tsibble()
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
rv <- stonkdata$RV[-1]
stonks_data1 <- cbind(x, rv)
stonkdata <- stonks %>%
filter(Symbol == ".SPX" & year(X1) > 2011) %>%
select(X1,close_price, rv5) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rv5) %>%
mutate(RV = log(RV)
) %>%
as_tsibble()
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
rv <- stonkdata$RV[-1]
stonks_data1 <- cbind(x, rv)
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
stonkdata <- stonks %>%
filter(Symbol == ".SPX" & year(X1) > 2011) %>%
select(X1,close_price, rv5) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)
) %>%
as_tsibble()
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
rv <- stonkdata$RV[-1]
stonks_data1 <- cbind(x, rv)
returns
stonkdata
source("functions.R")
sig_eps <- (pi^2)/2
mean_u <- -1.27
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
sig_eps <- (pi^2)/2
mean_u <- -1.27
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.25, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
sig_eps <- (pi^2)/2
mean_u <- -1.27
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, 0.25, 0.0)
par_ini1 <- c(0.2, 0.95, 0.0, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, -0.25)
par_ini1 <- c(0.2, 0.95, 0.0, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
par_ini1 <- c(0.2, 0.95, 0.0, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
source("functions.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
sig_eps <- (pi^2)/2
source("functions.R")
sig_eps <- (pi^2)/2
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
par_ini <- c(0.08, 0.95, -0.25, 0)
par_ini <- c(0.1, 0.95, -0.25, 0)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
par_ini <- c(0.1, 0.9, 0, 0)
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
par_ini <- c(0.5, 0.5, 0.5, 0)
source("functions.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.1082, 0.991, -0.207, 0.0)
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
par_ini <- c(0.1082, 0.991, -0.207, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
source("functions.R")
source("Plotting.R")
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
perform_QML_routine(returns, stockdata)
source("functions.R")
rm(list=ls())
# Imports ----------
source("functions.R")
source("Plotting.R")
library(here)
library(tidyverse)
library(tsibble)
library(lubridate)
library(scales)
library(ggplot2)
library(fable)
setwd(here())
options(warn=-1)
# Data import & cleaning --------
data <- read.delim(here('Data', 'sv.dat'))
stocks <- read_csv(here('Data', 'oxfordmanrealizedvolatilityindices.csv'))
returns <- data %>%
mutate(index = 1:nrow(data)) %>%
relocate(index) %>%
as_tsibble(index = index) %>%
rename(x = X...Pound.Dollar.daily.exchange.rates..sections.9.6.and.14.4) %>%
mutate(demeaned = (x - mean(x))/100,
transformed = log(demeaned^2))
stockdata <- stocks %>%
filter(Symbol == ".SPX" & year(X1) > 2015) %>%
select(X1,close_price, rk_parzen) %>% # replace rk_parzen with realized volatility measure of choice
rename(Date = X1, Close = close_price, RV = rk_parzen) %>%
mutate(RV = log(RV)) %>%
as_tsibble()
perform_QML_routine(returns, stockdata)
# QML / cde?
y <- diff(log(stonkdata$Close))
x <- log((y - mean(y))^2)
rv <- stonkdata$RV[-1]
stonks_data1 <- cbind(x, rv)
sig_eps <- (pi^2)/2
mean_u <- -1.27
par_ini <- c(0.1082, 0.991, -0.207, 0.0)
Z <- 1
H <- sig_eps
T <- par_ini[2]
R <- par_ini[1]
Q <- 1
Beta <- par_ini[4]
c <- par_ini[3]
d <- mean_u
state_space_parameters <- data.frame(Z, H, T, R, Q, Beta, c, d)
ret_trans <- returns$transformed
res <- state_space_parameter_optimizer(ret_trans, par_ini, state_space_parameters)
res2 <- state_space_parameter_optimizer(stonks_data1, par_ini, state_space_parameters)
# e)
perform_QML_routine(returns, stockdata)
perform_QML_routine(returns, stockdata)
